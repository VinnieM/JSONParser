<?xml version="1.0"?>
<project name="JSONParser" default="all" basedir=".">

	<target name="init">
		<echo>+---------------------------------------------------------+</echo>
		<echo>+    Project JSON Parser Initiation           						+</echo>
		<echo>+---------------------------------------------------------+</echo>
		<property name="prjJsonParser_base.home" value="../../"/>
		<property name="prjJsonParser_base.lib" value="../../lib"/>

		<!-- The destination directory for the build -->
		<property name="jsonParser.home" value="${prjJsonParser_base.home}/JSONParser"/>
		<property name="jsonParser.build" value="${jsonParser.home}/build"/>
		<property name="jsonParser.src" value="${jsonParser.home}/JsonParserMain"/>
		<property name="jsonParser.test" value="${jsonParser.home}/JsonParserTest"/>
		<property name="jsonParser.lib" value="${jsonParser.home}/lib"/>
		<property name="jsonParser.etc" value="${jsonParser.home}/etc"/>
		<property name="jsonParser.classes" value="${jsonParser.build}/classes"/>
		<property name="jsonParser.release" value="${jsonParser.home}/release"/>

		<!-- Setting the TimeStamp -->
		<tstamp>
			<format property="timestamp" pattern="yyyy-MM-dd" locale="en,UK"/>
		</tstamp>

		<!-- ********************************************************************** -->
		<!--        									Classpath             												-->
		<!-- ********************************************************************** -->

		<path id="jsonParser.classpath">
		<!-- Project Specific Library Files -->
			<fileset dir="${jsonParser.lib}">
				<include name="**/*.jar"/>
			</fileset>
		<!-- Utils will go here-->
		</path>
		<!-- Task Definition for Apache Ant contrib-->
		<taskdef resource="net/sf/antcontrib/antlib.xml"/>
	</target>

	<target name="compile" depends="init">
		<echo>+--------------------------------------------------------------------------+</echo>
		<echo>+        JSON Parser Service Layer Service Compilation				 						 +</echo>
		<echo>+--------------------------------------------------------------------------+</echo>
		<mkdir dir="${jsonParser.classes}"/>
		<javac  srcdir="${jsonParser.src}" destdir="classes"  debug="true">
			<classpath refid="jsonParser.classpath" />
		</javac>
		<mkdir dir="${jsonParser.classes}/etc"/>
		<copy todir="${jsonParser.classes}/etc">
			<fileset dir="${jsonParser.etc}">
				<include name="**/*.*"/>
			</fileset>
		</copy>
	</target>

	<target name="jar_nocompile">
		<echo>+-----------------------------------------------------------------------+</echo>
		<echo>+           Packaging JSON Parser Service layer Service             		+</echo>
		<echo>+-----------------------------------------------------------------------+</echo>
		<mkdir dir="${jsonParser.release}"/>
		<jar jarfile="${jsonParser.release}/${timestamp}/jsonParser.jar" basedir="${jsonParser.classes}">
			<manifest>
				<attribute name="Main-Class" value="code.java.jsonp.ApplicationMain" />
			</manifest>
		</jar>
	</target>

	<target name="jar" depends="compile, jar_nocompile"/>
	<target name="release_nojar">
		<echo>+---------------------------------------------------------------------------------+</echo>
		<echo>+            Releasing JSON Parser Service layer Service Package	                +</echo>
		<echo>+---------------------------------------------------------------------------------+</echo>
		<copy todir="${jsonParser.release}">
			<fileset dir="${jsonParser.release}">
				<include name="**/*.*"/>
			</fileset>
		</copy>
	</target>
	<target name="release" depends="jar, release_nojar"/>

	<target name="clean" depends="init">
		<echo>+------------------------------------------------------------------------------------------+</echo>
		<echo>+                   Clean JSONP Service Management Service Package               	 				 +</echo>
		<echo>+------------------------------------------------------------------------------------------+</echo>
		<delete includeEmptyDirs="true" failonerror="false">
			<fileset dir="${jsonParser.build}">
				<include name="**"/>
				<exclude name="*.bat"/>
				<exclude name="*.xml"/>
				<exclude name="cvs/**"/>
			</fileset>
		</delete>
		<delete failonerror="false" includeEmptyDirs="true">
			<fileset dir="${jsonParser.release}">
				<include name="**"/>
				<exclude name="**/**.jar"/>
				<exclude name="**/**.yml"/>
				<exclude name="cvs/**"/>
			</fileset>
		</delete>
	</target>

	<target name="all" depends="release,clean">
		<echo>+-------------------------------------------------------------------------+</echo>
		<echo>+          JSONP layer Service Build - Done             									+</echo>
		<echo>+-------------------------------------------------------------------------+</echo>
	</target>

</project>
